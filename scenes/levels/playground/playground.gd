class_name Levels
extends Node2D

var parralax_ly: ParallaxLayer:
	get: return $ParallaxBackground/Parallax1

static var instance :Levels

static var vfx_particle_node :Node2D:
	get: return instance.get_node("%Particles")
static var player_node :Node2D:
	get: return instance.get_node("%Player")
static var enemy_node :Node2D:
	get: return instance.get_node("%Enemies")
static var vfx_shader_node :Node2D:
	get: return instance.get_node("%Shaders")

var camera_node: Camera2D:
	get: return await CAV.get_camera_node()

func _init() -> void:
	instance = self

func _physics_process(delta: float) -> void:
	var magic := get_viewport_rect().size*0.5*pow(1-parralax_ly.motion_scale.x,1)*(1.0 + 1.0/CAV.camera_node.zoom.x)
	parralax_ly.motion_offset = magic

	vfx_shader_node.global_position = camera_node.global_position - CAV.const_viewport_resolution/2
