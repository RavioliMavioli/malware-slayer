class_name Levels
extends Node2D

var parralax_bg: ParallaxBackground:
	get: return $ParallaxBackground
var parralax_layers: Array:
	get: return parralax_bg.get_children()
	
static var instance :Levels

static var pooled_node :Node2D:
	get: return instance.get_node("%PooledNodes")
static var vfx_particle_node :Node2D:
	get: return instance.get_node("%Particles")
static var player_node :Node2D:
	get: return instance.get_node("%Player")
static var enemy_node :Node2D:
	get: return instance.get_node("%Enemies")
static var vfx_shader_node :Node2D:
	get: return instance.get_node("%Shaders")
static var dropable_node :Node2D:
	get: return instance.get_node("%Dropables")
static var other_node :Node2D:
	get: return instance.get_node("%Others")

var camera: Camera2D:
	get: return Camera.instance
	
var shaders_parent: Node2D:
	get: return %ShadersParent

func _init() -> void:
	instance = self

func _physics_process(delta: float) -> void:
	
	for l in parralax_layers:
		var magic := get_viewport_rect().size * 0.5 * pow(1-l.motion_scale.x,1) * (1.0 + 1.0/camera.zoom.x)
		l.motion_offset = magic

	shaders_parent.scale = camera.zoom
