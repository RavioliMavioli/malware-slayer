extends Control

@export var next_scene: PackedScene
@export var contribs_file = 'res://etc/contributors.txt'
@export var patrons_file = 'res://etc/patrons.txt'

var contribs: RichTextLabel:
	get: return %Contribs
	
var patrons: RichTextLabel:
	get: return %Pats

func _ready() -> void:
	_load_file(contribs_file, contribs)
	_load_file(patrons_file, patrons)

func _input(event: InputEvent) -> void:
	if event is InputEventKey or event is InputEventMouseButton:
		if event.pressed:
			_change_scene()

func _on_anim_animation_finished(anim_name: StringName) -> void:
		_change_scene()
	
func _change_scene() -> void:
	SceneManager.set_target_scene(next_scene)
	SceneManager.change_scene_quick()

func _load_file(path: String, text_label: RichTextLabel):
	var files := FileAccess.open(path, FileAccess.READ)
	var text := ""
	while not files.eof_reached(): # iterate through all lines until the end of file is reached
		text += "[cell][left]\n	" + files.get_line() + "[/left][/cell]"
	text_label.text = "[center][table=3,2]" + text + "[/table][/center]"
	files.close()
	
