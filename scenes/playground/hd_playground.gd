extends Node

@onready var placable_text: Node2D = $PlacableText

@onready var view_box: SubViewportContainer = $SubViewportContainer
@onready var sub_viewport: SubViewport = $SubViewportContainer/SubViewport
@onready var screen_res: Vector2 = get_viewport().size as Vector2

const HEIGHT: int = 1024
const WIDTH: int = 576

func _ready():
	
	CAV.viewport_container_node = view_box
	CAV.viewport_node = sub_viewport
	
	#################### Screen Size ########################
	
	sub_viewport.size = Vector2i(HEIGHT, WIDTH)
	view_box.size = sub_viewport.size
	
	CAV.container_default_position = view_box.position
	CAV.container_default_size = sub_viewport.size as Vector2
	CAV.container_default_scaling = screen_res / CAV.container_default_size
	
	CAV.screen_resolution = screen_res
	
	view_box.scale = CAV.container_default_scaling

func _physics_process(delta):
	

	var resized_screen_center: Vector2 = CAV.container_default_size * view_box.scale / 2
	var screen_center: Vector2 = CAV.screen_resolution / 2
	var d_screen_center: Vector2 = screen_center - resized_screen_center

	placable_text.scale = view_box.scale
	placable_text.global_position = -CAV.camera_node.global_position * view_box.scale + d_screen_center
