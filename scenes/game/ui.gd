extends CanvasLayer

var terminal_bar: TextureProgressBar:
	get: return %TerminalBar

var terminal_bar_val: float:
	set(val):
		var parent = terminal_bar.get_parent().get_parent()
		var speed = 0.75 * Engine.time_scale
		terminal_bar_val = val
		if val <= 25.0:
			var tween = get_tree().create_tween()
			tween.tween_property(parent, "modulate", Color.RED, speed)
		elif val <= 50.0:
			var tween = get_tree().create_tween()
			tween.tween_property(parent, "modulate", Color.YELLOW, speed)
		elif val <= 75.0:
			var tween = get_tree().create_tween()
			tween.tween_property(parent, "modulate", Color.GREEN_YELLOW, speed)
		elif val <= 100.0:
			var tween = get_tree().create_tween()
			tween.tween_property(parent, "modulate", Color.WHITE, speed)

func _process(delta: float) -> void:
	_terminal_bar(delta)
	
func _terminal_bar(delta) -> void:
	var DM = delta * 1/Engine.time_scale
	terminal_bar_val = Terminal.instance.processing_power
	terminal_bar.value = lerp(terminal_bar.value, terminal_bar_val, DM * 10)
