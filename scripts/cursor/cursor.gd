class_name Cursor extends Node2D

signal cursor_state_changed

enum CURSOR_STATE {NORMAL, AIM}

static var instance: Cursor
static var current_cursor_state: CURSOR_STATE = CURSOR_STATE.NORMAL:
	set(new_state):
		if current_cursor_state == new_state:
			return
		current_cursor_state = new_state
		instance.cursor_state_changed.emit()

var anim: AnimationPlayer:
	get: return $AnimationPlayer

func _init() -> void:
	instance = self

func _ready():
	current_cursor_state = CURSOR_STATE.AIM
	cursor_state_changed.connect(_cursor_changed)

func _process(_delta):
	# Prevent being affected by slowmo
	anim.speed_scale = 1/Engine.time_scale

func _physics_process(_delta):
	_crosshair_physics()

func _cursor_changed():
	match current_cursor_state:
		CURSOR_STATE.NORMAL:
			anim.play("to_normal")
		CURSOR_STATE.AIM:
			anim.play("to_aim")
			
func _crosshair_physics():
	global_position = get_global_mouse_position()
