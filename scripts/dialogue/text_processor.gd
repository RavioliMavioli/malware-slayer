class_name DialogueTextProcessor extends Node2D

signal finished

var text_displayer: DialogueTextDisplayer:
	get: return %TextDisplayer

var arr_text: Array
var displayed_text: String
var arr_text_index: int
var character_name: String
var portrait: ImageTexture

func _ready() -> void:
	text_displayer.finished.connect(_text_finished)

func start(_arr_text: Array, _character_name: String) -> void:
	character_name = _character_name
	arr_text_index = 0
	arr_text = _arr_text
	displayed_text = arr_text[arr_text_index]
	_start_displayer()

func _text_finished() -> void:
	arr_text_index += 1
	await text_displayer.next
	if arr_text_index >= arr_text.size():
		finished.emit()
		return
	displayed_text = arr_text[arr_text_index]
	_start_displayer()
	
func _start_displayer() -> void:
	text_displayer.start(displayed_text, character_name)

func _process_image(_img_name: String) -> void:
	pass
