class_name PlayerShootControls extends Node2D

var player: Player:
	get: return owner
var shoot_components: Array[ShootComponent]:
	get: return [get_node("%ShootComponent1"), get_node("%ShootComponent2")]
var aim_center: Marker2D:
	get: return %AimCenter
var index := 0

func _ready() -> void:
	shoot_components[0].set_projectile_spawn(aim_center.get_node("%BulletSpawn/1"))
	shoot_components[1].set_projectile_spawn(aim_center.get_node("%BulletSpawn/2"))
	
func _input(event: InputEvent) -> void:
	if !Player.enable_input:
		for i in shoot_components:
			i.unshoot()
		return
	if event.is_action_pressed("Shoot_1"):
		shoot_components[index].shoot()
	if event.is_action_released("Shoot_1"):
		shoot_components[index].unshoot()
		index = wrapi(index + 1, 0, shoot_components.size())

func _physics_process(delta:float) -> void:
	aim_center.look_at(player.get_global_mouse_position())
