extends Node

var target_scene
var loading_screen_path := "res://scripts/scene_manager/loading_screen.tscn"
var fading_bg_path := "res://scripts/scene_manager/fading_bg.tscn"
var skip_button_press := false
var skip_fading := false

func set_target_scene(	_target_scene,
						_skip_button_press: bool = false,
						_skip_fading: bool = false) -> void:
							
	target_scene = _target_scene
	skip_button_press = _skip_button_press
	skip_fading = _skip_fading
	
func get_target_scene():
	return target_scene

func change_scene() -> void:
	Timemode.reset_time_mode()
	if !skip_fading:
		var fading_bg = load(fading_bg_path).instantiate()
		get_tree().current_scene.add_child(fading_bg)
		await fading_bg.get_node("Animation").animation_finished

	_convert_packedscene()
	get_tree().change_scene_to_file(loading_screen_path)

func change_scene_quick() -> void:
	Timemode.reset_time_mode()
	_convert_packedscene()
	get_tree().change_scene_to_file(target_scene)

func _convert_packedscene():
	if target_scene is PackedScene:
		target_scene = target_scene.get_path()
