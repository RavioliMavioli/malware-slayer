class_name Trail extends Line2D

var queue_trail: Array
var node: Object
var max_length: int

func destroy() -> void:
	var tween1:Tween = create_tween()
	tween1.tween_property(self, "modulate:a", 0.0, 0.2)
	tween1.connect("finished", _on_tween_finished)
	set_physics_process(false)
	return
	
func _physics_process(delta):
	if node == null:
		destroy()
		return
	queue_trail.push_front(node.global_position)
	if queue_trail.size() > max_length:
		queue_trail.pop_back()
	clear_points()
	for p in queue_trail:
		add_point(p)

func _on_tween_finished():
	queue_free()
